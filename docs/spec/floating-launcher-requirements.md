# フローティングアイコンランチャー 要件定義書

## 概要

Windows OSで動作する軽量なフローティングアイコンランチャーを作成する。画面上に常時表示されるフローティングアイコンをクリックすることで、指定したアプリケーションを起動できる。Pythonで開発し、PyInstallerでexeファイルに変換して配布する。

## ユーザストーリー

### ストーリー1: アプリケーションの素早い起動

- **である** PCユーザー **として**
- **私は** フローティングアイコンをクリックして特定のアプリを素早く起動 **したい**
- **そうすることで** スタートメニューやデスクトップを探さなくても効率的に作業できる

### ストーリー2: フローティング位置の固定

- **である** PCユーザー **として**
- **私は** フローティングアイコンの表示位置を設定で固定 **したい**  
- **そうすることで** 常に同じ場所からアプリを起動でき、使い勝手が向上する

### ストーリー3: 起動アプリケーションのカスタマイズ

- **である** PCユーザー **として**
- **私は** フローティングアイコンから起動するアプリケーションを自由に設定 **したい**
- **そうすることで** 自分の作業環境に最適化されたランチャーとして利用できる

## 機能要件（EARS記法）

### 通常要件

- REQ-001: システムはWindows OS上でフローティングアイコンを表示しなければならない
- REQ-002: システムはアイコンクリック時に指定されたアプリケーションを起動しなければならない
- REQ-003: システムはフローティングアイコンを他のウィンドウより前面に表示しなければならない
- REQ-004: システムは起動するアプリケーションのパスと実行ファイル名を保存しなければならない
- REQ-005: システムはPython環境で動作しなければならない
- REQ-006: システムはPyInstallerによりexeファイルへの変換が可能でなければならない

### 条件付き要件

- REQ-101: ユーザーがアイコン位置固定設定を有効にした場合、システムはフローティングアイコンを指定座標に固定表示しなければならない
- REQ-102: ユーザーがアイコンを右クリックした場合、システムは設定メニューを表示しなければならない
- REQ-103: 指定されたアプリケーションが存在しない場合、システムはエラーメッセージを表示しなければならない
- REQ-104: 管理者権限が必要なアプリケーションの場合、システムは権限昇格を促すか、エラーメッセージを表示しなければならない

### 状態要件

- REQ-201: システムが起動状態にある場合、フローティングアイコンは常に表示されなければならない
- REQ-202: 設定画面が表示されている場合、システムは既存の設定値を初期表示しなければならない
- REQ-203: アプリケーション起動中の場合、システムは重複起動を防ぐか確認ダイアログを表示してもよい

### オプション要件

- REQ-301: システムは複数のアプリケーションを登録できてもよい
- REQ-302: システムはアイコンの見た目（色、形、サイズ）をカスタマイズできてもよい
- REQ-303: システムは起動履歴を保存してもよい
- REQ-304: システムはホットキーによるアプリケーション起動をサポートしてもよい

### 制約要件

- REQ-401: システムはWindows OS専用でなければならない
- REQ-402: システムはメモリ使用量が50MB以下でなければならない
- REQ-403: システムは.NET Frameworkなどの追加ランタイムに依存してはならない
- REQ-404: システムはウイルススキャンで誤検知されない実装でなければならない

## 非機能要件

### パフォーマンス

- NFR-001: システムの起動時間は3秒以内でなければならない
- NFR-002: アイコンクリックからアプリケーション起動まで1秒以内でなければならない
- NFR-003: システムのCPU使用率は通常時0.1%以下でなければならない
- NFR-004: フローティングアイコンの描画更新は60FPS以上でなければならない

### セキュリティ

- NFR-101: システムは悪意のあるファイルパスの実行を防ぐ検証機能を持たなければならない
- NFR-102: システムは設定ファイルへの不正アクセスを検知しなければならない
- NFR-103: システムはネットワーク通信を一切行ってはならない

### ユーザビリティ

- NFR-201: フローティングアイコンは視認しやすいデザインでなければならない
- NFR-202: 設定画面は直感的で分かりやすいUIでなければならない
- NFR-203: システムはタスクトレイアイコンからの終了機能を提供しなければならない
- NFR-204: システムはWindows起動時の自動起動設定を提供しなければならない

### 互換性

- NFR-301: システムはWindows 10以降で動作しなければならない
- NFR-302: システムは高DPI環境で正常に表示されなければならない
- NFR-303: システムは複数モニター環境に対応しなければならない

## Edgeケース

### エラー処理

- EDGE-001: 指定アプリケーションファイルが削除された場合の処理
- EDGE-002: 設定ファイルが破損した場合の初期化処理
- EDGE-003: 権限不足でアプリケーション起動に失敗した場合の処理
- EDGE-004: 同じアプリケーションが既に起動している場合の処理
- EDGE-005: システムリソース不足時の動作

### 境界値

- EDGE-101: 画面外座標へのアイコン配置指定時の処理
- EDGE-102: 異常に長いファイルパス（260文字超）の処理
- EDGE-103: 最小・最大ウィンドウサイズでの表示処理
- EDGE-104: 起動アプリケーション設定数の上限（メモリ制限考慮）

### システム環境

- EDGE-201: Pythonランタイムが見つからない場合（exe化前）
- EDGE-202: ディスプレイ設定変更時（解像度・DPI変更）
- EDGE-203: システム休止・復帰時の状態復元
- EDGE-204: 他アプリケーションとのフォーカス競合時の処理

## 受け入れ基準

### 機能テスト

- [ ] Windows 10/11でフローティングアイコンが正常に表示される
- [ ] アイコンクリックで指定アプリケーションが起動する
- [ ] 右クリックメニューから設定画面が開く
- [ ] アイコン位置固定設定が正しく動作する
- [ ] 起動アプリケーションの変更が正しく保存される
- [ ] exe化後も正常に動作する
- [ ] タスクトレイからアプリケーションを終了できる
- [ ] 存在しないファイル指定時にエラーメッセージが表示される

### 非機能テスト

- [ ] 起動時間が3秒以内である
- [ ] アプリ起動レスポンスが1秒以内である
- [ ] メモリ使用量が50MB以下である
- [ ] CPU使用率が通常時0.1%以下である
- [ ] 高DPI環境で正常に表示される
- [ ] 複数モニター環境で正常に動作する
- [ ] 長時間稼働時もメモリリークが発生しない

### セキュリティテスト

- [ ] 悪意のあるファイルパス指定時に適切に拒否される
- [ ] 設定ファイル改ざん時に適切に検出・復旧される
- [ ] ネットワーク通信が一切発生しない

## 技術仕様

### 開発環境

- **言語**: Python 3.8以降
- **GUI フレームワーク**: tkinter（標準ライブラリ）
- **配布形式**: PyInstaller使用してexeファイル化
- **設定保存**: JSON形式でローカルファイル保存

### ファイル構成

```
floating-app/
├── main.py              # メインアプリケーション
├── floating_icon.py     # フローティングアイコン処理
├── app_launcher.py      # アプリケーション起動処理
├── settings_ui.py       # 設定画面UI
├── config_manager.py    # 設定ファイル管理
├── requirements.txt     # 依存ライブラリ
├── build_exe.py        # PyInstallerビルドスクリプト
└── docs/
    └── spec/
        └── floating-launcher-requirements.md
```

### 設定ファイル形式

```json
{
  "app_path": "C:\\Program Files\\AppName\\app.exe",
  "icon_position": {"x": 100, "y": 100},
  "icon_fixed": true,
  "auto_start": false,
  "icon_size": 32
}
```