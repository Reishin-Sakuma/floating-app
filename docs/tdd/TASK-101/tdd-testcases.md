# TASK-101: アプリケーション起動エンジン - テストケース

## テストケース一覧

### 基本機能テスト

#### TC-001: AppLauncher初期化
- **目的**: AppLauncherが正常に初期化される
- **前提条件**: なし
- **実行手順**:
  1. AppLauncherインスタンスを作成
- **期待結果**: 
  - インスタンスが正常に作成される
  - 内部状態が適切に初期化される

#### TC-002: 有効な実行ファイルの検証
- **目的**: 有効な実行ファイルが正しく検証される
- **前提条件**: 有効な.exeファイルが存在
- **実行手順**:
  1. 有効な実行ファイルパスでis_valid_executable()を呼び出し
- **期待結果**:
  - Trueが返される

#### TC-003: 無効なファイルの検証
- **目的**: 無効なファイルが適切に拒否される
- **前提条件**: .txtファイルが存在
- **実行手順**:
  1. テキストファイルパスでis_valid_executable()を呼び出し
- **期待結果**:
  - Falseが返される

### アプリケーション起動テスト

#### TC-101: 正常なアプリケーション起動
- **目的**: 有効なアプリケーションが正常に起動される
- **前提条件**: メモ帳（notepad.exe）が利用可能
- **実行手順**:
  1. notepad.exeのフルパスでlaunch_application()を呼び出し
- **期待結果**:
  - LaunchResult.success = True
  - process_idが正の整数
  - error_messageがNone
  - execution_time < 1000ms

#### TC-102: 存在しないファイルの起動試行
- **目的**: 存在しないファイル指定時の適切なエラーハンドリング
- **前提条件**: 存在しないファイルパス
- **実行手順**:
  1. 存在しないパスでlaunch_application()を呼び出し
- **期待結果**:
  - LaunchResult.success = False
  - process_id = None
  - error_messageにFileNotFoundError系のメッセージ

#### TC-103: 引数付きアプリケーション起動
- **目的**: コマンドライン引数付きでアプリケーションが起動される
- **前提条件**: notepad.exeが利用可能
- **実行手順**:
  1. notepad.exeに引数リストを渡してlaunch_application()を呼び出し
- **期待結果**:
  - LaunchResult.success = True
  - 指定した引数でアプリケーションが起動される

### セキュリティ検証テスト

#### TC-201: パストラバーサル攻撃の防止
- **目的**: パストラバーサル攻撃が適切に防止される
- **前提条件**: なし
- **実行手順**:
  1. "../../../Windows/System32/cmd.exe"のような悪意のあるパスでlaunch_application()を呼び出し
- **期待結果**:
  - LaunchResult.success = False
  - セキュリティエラーメッセージが返される

#### TC-202: 無効な拡張子の拒否
- **目的**: 実行ファイル以外の拡張子が拒否される
- **前提条件**: .txtファイルが存在
- **実行手順**:
  1. .txtファイルでlaunch_application()を呼び出し
- **期待結果**:
  - LaunchResult.success = False
  - 無効なファイル形式のエラーメッセージ

#### TC-203: 長いファイルパスの処理
- **目的**: 異常に長いファイルパスが適切に処理される
- **前提条件**: 260文字を超えるパス文字列
- **実行手順**:
  1. 長いファイルパスでlaunch_application()を呼び出し
- **期待結果**:
  - LaunchResult.success = False
  - パス長エラーメッセージ

#### TC-204: 特殊文字を含むパスの処理
- **目的**: 特殊文字を含むパスが適切に処理される
- **前提条件**: 特殊文字（<>|"*?）を含むパス
- **実行手順**:
  1. 特殊文字を含むパスでlaunch_application()を呼び出し
- **期待結果**:
  - 適切な検証とエラー処理

### 権限管理テスト

#### TC-301: 管理者権限判定
- **目的**: 管理者権限が必要なアプリの判定が正しく行われる
- **前提条件**: システムアプリケーション（regedit.exe）
- **実行手順**:
  1. regedit.exeでrequires_admin_privileges()を呼び出し
- **期待結果**:
  - Trueが返される（多くの場合）

#### TC-302: 通常権限判定
- **目的**: 通常権限で実行可能なアプリの判定が正しく行われる
- **前提条件**: notepad.exe
- **実行手順**:
  1. notepad.exeでrequires_admin_privileges()を呼び出し
- **期待結果**:
  - Falseが返される

#### TC-303: 管理者権限での起動
- **目的**: 管理者権限でのアプリケーション起動が適切に処理される
- **前提条件**: 管理者権限が必要なアプリケーション
- **実行手順**:
  1. launch_with_admin()を呼び出し
- **期待結果**:
  - UAC処理が適切に実行される
  - 権限昇格後の起動が成功する

### プロセス管理テスト

#### TC-401: 起動中アプリケーションの検出
- **目的**: 実行中のアプリケーションが正しく検出される
- **前提条件**: notepad.exeが起動済み
- **実行手順**:
  1. notepad.exeでis_application_running()を呼び出し
- **期待結果**:
  - Trueが返される

#### TC-402: 停止中アプリケーションの検出
- **目的**: 実行していないアプリケーションが正しく検出される
- **前提条件**: notepad.exeが停止済み
- **実行手順**:
  1. notepad.exeでis_application_running()を呼び出し
- **期待結果**:
  - Falseが返される

#### TC-403: プロセス情報の取得
- **目的**: 実行中プロセスの詳細情報が正しく取得される
- **前提条件**: notepad.exeが起動済み
- **実行手順**:
  1. プロセスIDでget_process_info()を呼び出し
- **期待結果**:
  - ProcessInfoオブジェクトが返される
  - 適切なプロセス情報が格納されている

#### TC-404: アプリケーションの強制終了
- **目的**: 起動中のアプリケーションが適切に終了される
- **前提条件**: notepad.exeが起動済み
- **実行手順**:
  1. notepad.exeでkill_application()を呼び出し
- **期待結果**:
  - Trueが返される
  - アプリケーションが終了される

### エラーハンドリングテスト

#### TC-501: 権限不足エラー
- **目的**: 権限不足時の適切なエラーハンドリング
- **前提条件**: 管理者権限が必要なアプリ、通常ユーザー実行
- **実行手順**:
  1. 権限不足状態でlaunch_application()を呼び出し
- **期待結果**:
  - LaunchResult.success = False
  - 権限エラーメッセージ

#### TC-502: メモリ不足エラー
- **目的**: システムリソース不足時の処理
- **前提条件**: メモリ不足状況をシミュレート
- **実行手順**:
  1. リソース不足状態でlaunch_application()を呼び出し
- **期待結果**:
  - 適切なエラーハンドリング
  - リソースエラーメッセージ

#### TC-503: 破損した実行ファイル
- **目的**: 破損した実行ファイルの処理
- **前提条件**: 破損した.exeファイル
- **実行手順**:
  1. 破損ファイルでlaunch_application()を呼び出し
- **期待結果**:
  - LaunchResult.success = False
  - ファイル破損エラーメッセージ

### パフォーマンステスト

#### TC-601: 起動時間測定
- **目的**: アプリケーション起動時間が要件を満たす
- **前提条件**: notepad.exe
- **実行手順**:
  1. 時間測定しながらlaunch_application()を呼び出し
- **期待結果**:
  - execution_time < 1000ms
  - 通常起動は500ms以内

#### TC-602: 複数同時起動
- **目的**: 複数アプリケーションの同時起動性能
- **前提条件**: 複数の軽量アプリケーション
- **実行手順**:
  1. 並行して複数のlaunch_application()を呼び出し
- **期待結果**:
  - 全て正常に起動される
  - デッドロックが発生しない

#### TC-603: メモリ使用量測定
- **目的**: メモリ使用量が要件を満たす
- **前提条件**: メモリ測定環境
- **実行手順**:
  1. AppLauncherの使用前後でメモリ使用量を測定
- **期待結果**:
  - 待機時5MB以下
  - 処理中10MB以下

### 統合テスト

#### TC-701: ConfigManagerとの連携
- **目的**: 設定ファイルからの起動が正常に動作する
- **前提条件**: ConfigManagerが設定済み
- **実行手順**:
  1. ConfigManagerから取得したapp_pathでlaunch_application()を呼び出し
- **期待結果**:
  - 設定された通りにアプリケーションが起動される

#### TC-702: 起動履歴の記録
- **目的**: アプリケーション起動履歴が適切に記録される
- **前提条件**: 履歴機能が有効
- **実行手順**:
  1. 複数回のアプリケーション起動
  2. 起動履歴の確認
- **期待結果**:
  - 起動時刻、アプリケーション名、結果が記録される

### Windowsシステムテスト

#### TC-801: UAC対応テスト
- **目的**: UACプロンプトが適切に処理される
- **前提条件**: Windows UAC有効環境
- **実行手順**:
  1. 管理者権限が必要なアプリでlaunch_with_admin()を呼び出し
- **期待結果**:
  - UACプロンプトが表示される
  - 許可後にアプリケーションが起動される

#### TC-802: レジストリアクセステスト
- **目的**: レジストリ情報の取得が正常に動作する
- **前提条件**: Windows環境
- **実行手順**:
  1. アプリケーション情報取得機能の実行
- **期待結果**:
  - レジストリから正しい情報が取得される

#### TC-803: プロセス監視テスト
- **目的**: Windows APIを使用したプロセス監視が動作する
- **前提条件**: Windows環境
- **実行手順**:
  1. プロセス監視機能の実行
- **期待結果**:
  - 正確なプロセス情報が取得される

## テスト実行順序

1. **基本機能テスト** (TC-001～TC-003)
2. **アプリケーション起動テスト** (TC-101～TC-103)
3. **セキュリティ検証テスト** (TC-201～TC-204)
4. **権限管理テスト** (TC-301～TC-303)
5. **プロセス管理テスト** (TC-401～TC-404)
6. **エラーハンドリングテスト** (TC-501～TC-503)
7. **パフォーマンステスト** (TC-601～TC-603)
8. **統合テスト** (TC-701～TC-702)
9. **Windowsシステムテスト** (TC-801～TC-803)

## テスト環境要件

- Windows 10/11環境
- 管理者権限での実行可能性
- メモリ測定ツール
- プロセス監視ツール
- 各種テスト用アプリケーション
  - notepad.exe（正常テスト用）
  - regedit.exe（権限テスト用）
  - 破損ファイル（エラーテスト用）

## モック・スタブ要件

- システム時刻モック（パフォーマンステスト用）
- メモリ使用量モック（リソーステスト用）
- プロセス実行モック（単体テスト用）
- UAC応答モック（権限テスト用）

## 合計テストケース数: 21個