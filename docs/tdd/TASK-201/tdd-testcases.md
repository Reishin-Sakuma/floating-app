# TASK-201: 設定画面UI - テストケース

## テストケース一覧

### 基本機能テスト

#### TC-001: SettingsWindow初期化
- **目的**: SettingsWindowが正常に初期化される
- **前提条件**: ConfigManagerが利用可能
- **実行手順**:
  1. ConfigManagerインスタンスを作成
  2. SettingsWindowインスタンスを作成
- **期待結果**: 
  - インスタンスが正常に作成される
  - 内部状態が適切に初期化される
  - 必要なメソッドが存在する

#### TC-002: 設定ウィンドウ表示
- **目的**: 設定ウィンドウが正常に表示される
- **前提条件**: SettingsWindowインスタンスが作成済み
- **実行手順**:
  1. show()メソッドを呼び出し
- **期待結果**:
  - ウィンドウが画面に表示される
  - 適切なサイズとタイトルが設定される
  - タブレイアウトが正しく構成される

#### TC-003: 設定ウィンドウ非表示
- **目的**: 設定ウィンドウが正常に非表示になる
- **前提条件**: SettingsWindowが表示状態
- **実行手順**:
  1. hide()メソッドを呼び出し
- **期待結果**:
  - ウィンドウが画面から消える
  - リソースが適切に管理される

### 設定管理テスト

#### TC-101: 設定値の読み込み
- **目的**: ConfigManagerから設定が正しく読み込まれる
- **前提条件**: 有効な設定ファイルが存在
- **実行手順**:
  1. 既知の設定値をConfigManagerに保存
  2. SettingsWindowを作成・表示
- **期待結果**:
  - UIに正しい設定値が反映される
  - 全設定項目が適切に表示される

#### TC-102: 設定値の保存
- **目的**: UI設定値が正しく保存される
- **前提条件**: SettingsWindowが表示状態
- **実行手順**:
  1. UI設定値を変更
  2. apply_settings()を呼び出し
- **期待結果**:
  - 変更された設定がConfigManagerに保存される
  - 保存処理が正常に完了する

#### TC-103: 設定値の検証
- **目的**: 無効な設定値が適切に検証される
- **前提条件**: SettingsWindowが表示状態
- **実行手順**:
  1. 無効な設定値を入力
  2. validate_settings()を呼び出し
- **期待結果**:
  - 検証エラーが検出される
  - 適切なエラーメッセージが返される

### ApplicationTab テスト

#### TC-201: アプリケーションパス選択
- **目的**: ファイルダイアログでアプリケーションが選択される
- **前提条件**: ApplicationTabが表示状態
- **実行手順**:
  1. 参照ボタンをクリック
  2. 有効な実行ファイルを選択
- **期待結果**:
  - ファイルダイアログが表示される
  - 選択されたパスがUIに反映される
  - アプリケーション情報が表示される

#### TC-202: アプリケーションパス検証
- **目的**: 選択されたアプリケーションパスが正しく検証される
- **前提条件**: ApplicationTabが表示状態
- **実行手順**:
  1. 無効なファイルパスを入力
  2. パス検証を実行
- **期待結果**:
  - 無効なパスが検出される
  - 適切なエラーメッセージが表示される

#### TC-203: アプリケーション情報取得
- **目的**: 選択されたアプリケーションの情報が取得される
- **前提条件**: 有効なアプリケーションが選択済み
- **実行手順**:
  1. get_application_info()を呼び出し
- **期待結果**:
  - アプリケーション名が取得される
  - ファイルサイズ・作成日時が表示される

#### TC-204: 履歴管理機能
- **目的**: アプリケーション選択履歴が適切に管理される
- **前提条件**: ApplicationTabが表示状態
- **実行手順**:
  1. 複数のアプリケーションを選択
  2. 履歴リストを確認
- **期待結果**:
  - 選択されたアプリケーションが履歴に追加される
  - 履歴からの再選択が可能

### AppearanceTab テスト

#### TC-301: 位置設定機能
- **目的**: アイコン位置が正しく設定される
- **前提条件**: AppearanceTabが表示状態
- **実行手順**:
  1. X・Y座標値を入力
  2. 設定を適用
- **期待結果**:
  - 入力された座標値が保存される
  - プレビューが更新される

#### TC-302: 位置プレビュー機能
- **目的**: 位置設定のプレビューが正しく表示される
- **前提条件**: AppearanceTabが表示状態
- **実行手順**:
  1. 位置座標を変更
  2. プレビュー領域を確認
- **期待結果**:
  - プレビュー内でアイコン位置が更新される
  - 座標値と表示位置が一致する

#### TC-303: ドラッグによる位置変更
- **目的**: ドラッグ操作で位置が変更される
- **前提条件**: AppearanceTabが表示状態
- **実行手順**:
  1. プレビュー領域でドラッグ操作
  2. 座標値の更新を確認
- **期待結果**:
  - ドラッグに追従してアイコンが移動
  - 座標値が自動で更新される

#### TC-304: サイズ設定機能
- **目的**: アイコンサイズが正しく設定される
- **前提条件**: AppearanceTabが表示状態
- **実行手順**:
  1. サイズスライダーを操作
  2. 数値入力で値を変更
- **期待結果**:
  - スライダーと数値入力が連動する
  - プレビューサイズが更新される

#### TC-305: 外観設定オプション
- **目的**: 外観設定オプションが正しく動作する
- **前提条件**: AppearanceTabが表示状態
- **実行手順**:
  1. ドロップシャドウ・透明度を変更
  2. テーマ選択を変更
- **期待結果**:
  - 各オプションが正しく反映される
  - プレビューが適切に更新される

### GeneralTab テスト

#### TC-401: 自動起動設定
- **目的**: 自動起動設定が正しく動作する
- **前提条件**: GeneralTabが表示状態
- **実行手順**:
  1. 自動起動チェックボックスを操作
  2. 設定を保存
- **期待結果**:
  - チェック状態が設定に反映される
  - システム統合設定が更新される

#### TC-402: システムトレイ設定
- **目的**: システムトレイ設定が正しく動作する
- **前提条件**: GeneralTabが表示状態
- **実行手順**:
  1. システムトレイ常駐設定を変更
  2. 設定を適用
- **期待結果**:
  - 設定が正しく保存される
  - 動作が適切に変更される

#### TC-403: 言語設定
- **目的**: 言語設定が正しく動作する
- **前提条件**: GeneralTabが表示状態
- **実行手順**:
  1. 言語選択コンボボックスを操作
  2. 異なる言語を選択
- **期待結果**:
  - 選択された言語が保存される
  - 将来的な多言語対応の準備

### UI/UXテスト

#### TC-501: ウィンドウサイズ・配置
- **目的**: ウィンドウのサイズと配置が適切
- **前提条件**: SettingsWindowが表示状態
- **実行手順**:
  1. ウィンドウの初期サイズを確認
  2. リサイズ操作を実行
- **期待結果**:
  - 適切な初期サイズで表示される
  - 最小サイズ制限が機能する

#### TC-502: タブレイアウト表示
- **目的**: タブレイアウトが正しく表示される
- **前提条件**: SettingsWindowが表示状態
- **実行手順**:
  1. 各タブをクリック
  2. タブ内容の表示を確認
- **期待結果**:
  - 全タブが正しく表示される
  - タブ切り替えが正常に動作する

#### TC-503: キーボード操作
- **目的**: キーボードによる操作が可能
- **前提条件**: SettingsWindowが表示状態
- **実行手順**:
  1. Tabキーでフォーカス移動
  2. Enter・Escapeキーでの操作
- **期待結果**:
  - 論理的なTab順序で移動する
  - キーボードで主要操作が可能

#### TC-504: ボタン操作
- **目的**: 各ボタンが正しく動作する
- **前提条件**: SettingsWindowが表示状態
- **実行手順**:
  1. OK・キャンセル・適用ボタンをクリック
  2. デフォルトボタンをクリック
- **期待結果**:
  - 各ボタンの機能が正しく実行される
  - 適切な処理結果が得られる

### エラーハンドリングテスト

#### TC-601: ファイル選択エラー処理
- **目的**: ファイル選択エラーが適切に処理される
- **前提条件**: ApplicationTabが表示状態
- **実行手順**:
  1. 存在しないファイルパスを入力
  2. 無効な拡張子のファイルを選択
- **期待結果**:
  - 適切なエラーメッセージが表示される
  - UI状態が安定に保たれる

#### TC-602: 設定値範囲エラー処理
- **目的**: 設定値の範囲エラーが適切に処理される
- **前提条件**: AppearanceTabが表示状態
- **実行手順**:
  1. 範囲外の座標値を入力
  2. 無効なサイズ値を入力
- **期待結果**:
  - 範囲外値が適切に制限される
  - エラーメッセージが表示される

#### TC-603: 設定保存エラー処理
- **目的**: 設定保存エラーが適切に処理される
- **前提条件**: SettingsWindowが表示状態
- **実行手順**:
  1. 読み取り専用ディスクでの保存試行
  2. 権限不足での保存試行
- **期待結果**:
  - 保存エラーが適切に通知される
  - データの整合性が保たれる

#### TC-604: UI例外エラー処理
- **目的**: UI操作での例外が適切に処理される
- **前提条件**: SettingsWindowが表示状態
- **実行手順**:
  1. 意図的に例外を発生させる操作
  2. エラー状態での回復操作
- **期待結果**:
  - アプリケーションがクラッシュしない
  - 適切なエラー回復処理が実行される

### パフォーマンステスト

#### TC-701: ウィンドウ表示性能
- **目的**: ウィンドウ表示が適切な速度で実行される
- **前提条件**: SettingsWindowが初期化済み
- **実行手順**:
  1. show()メソッド実行時間を測定
  2. 複数回実行して平均値を算出
- **期待結果**:
  - 0.5秒以内でウィンドウが表示される
  - レスポンシブな操作感を実現

#### TC-702: 設定変更反映性能
- **目的**: 設定変更の反映が高速に実行される
- **前提条件**: SettingsWindowが表示状態
- **実行手順**:
  1. 各設定項目の変更反映時間を測定
  2. プレビュー更新の応答性を確認
- **期待結果**:
  - プレビュー更新が0.1秒以内
  - UIが応答性良く動作する

#### TC-703: メモリ使用量
- **目的**: メモリ使用量が要件内に収まる
- **前提条件**: SettingsWindowが動作中
- **実行手順**:
  1. ウィンドウ表示後のメモリ使用量測定
  2. 長時間操作後のメモリリーク確認
- **期待結果**:
  - 追加メモリ使用量が5MB以下
  - メモリリークが発生しない

### 統合テスト

#### TC-801: ConfigManager連携
- **目的**: ConfigManagerとの連携が正常に動作する
- **前提条件**: ConfigManagerとSettingsWindow両方が利用可能
- **実行手順**:
  1. 設定値を変更して保存
  2. 別インスタンスで設定読み込み確認
- **期待結果**:
  - 設定変更が正しく永続化される
  - 設定読み込みが正常に動作する

#### TC-802: FloatingIcon連携
- **目的**: FloatingIconとの連携が正常に動作する
- **前提条件**: FloatingIconとSettingsWindow両方が利用可能
- **実行手順**:
  1. 位置・サイズ設定を変更
  2. FloatingIconの実際の表示を確認
- **期待結果**:
  - 設定変更がFloatingIconに即座に反映される
  - 表示と設定値が一致する

#### TC-803: マルチウィンドウ対応
- **目的**: 複数ウィンドウでの競合が適切に処理される
- **前提条件**: 複数のSettingsWindowインスタンス
- **実行手順**:
  1. 複数の設定ウィンドウを同時表示
  2. 異なるウィンドウで設定変更
- **期待結果**:
  - 設定競合が適切に管理される
  - データ整合性が保持される

#### TC-804: システム統合
- **目的**: OS機能との統合が正常に動作する
- **前提条件**: SettingsWindowが表示状態
- **実行手順**:
  1. 自動起動設定を有効化
  2. システム再起動後の動作確認
- **期待結果**:
  - OS機能との統合が正常に動作する
  - 設定が適切に反映される

### アクセシビリティテスト

#### TC-901: 高コントラストモード
- **目的**: 高コントラストモードで正常表示される
- **前提条件**: Windows高コントラストモード
- **実行手順**:
  1. 高コントラストモードを有効にする
  2. SettingsWindowを表示
- **期待結果**:
  - 適切なコントラストで表示される
  - 視認性が維持される

#### TC-902: キーボードアクセシビリティ
- **目的**: キーボードのみで操作可能
- **前提条件**: SettingsWindowが表示状態
- **実行手順**:
  1. マウスを使わずにキーボードのみで操作
  2. 全機能にアクセス可能か確認
- **期待結果**:
  - 全機能がキーボードでアクセス可能
  - 論理的なフォーカス順序で操作できる

#### TC-903: フォントサイズ対応
- **目的**: 異なるフォントサイズで適切に表示される
- **前提条件**: 異なるシステムフォントサイズ設定
- **実行手順**:
  1. システムフォントサイズを変更
  2. SettingsWindow表示を確認
- **期待結果**:
  - フォントサイズ変更に適応する
  - レイアウトが適切に調整される

## テスト実行順序

1. **基本機能テスト** (TC-001～TC-003)
2. **設定管理テスト** (TC-101～TC-103)
3. **ApplicationTabテスト** (TC-201～TC-204)
4. **AppearanceTabテスト** (TC-301～TC-305)
5. **GeneralTabテスト** (TC-401～TC-403)
6. **UI/UXテスト** (TC-501～TC-504)
7. **エラーハンドリングテスト** (TC-601～TC-604)
8. **パフォーマンステスト** (TC-701～TC-703)
9. **統合テスト** (TC-801～TC-804)
10. **アクセシビリティテスト** (TC-901～TC-903)

## テスト環境要件

### ハードウェア要件
- Windows 10/11 PC
- マルチモニター環境（可能であれば）
- 異なるDPI設定対応ディスプレイ
- 十分なメモリ・CPU リソース

### ソフトウェア要件
- Python 3.8以降 + tkinter
- pytest テストフレームワーク
- unittest.mock モジュール
- DPI設定変更権限

### テスト用モック・スタブ
- tkinterウィジェットのモック
- ファイルダイアログのシミュレーター
- ConfigManagerのテスト用実装
- 設定ファイルのモック

## GUI テスト特有の考慮事項

### 視覚確認要件
- 実際の画面表示確認
- レイアウト・配置の正確性確認
- 色・フォント・サイズの正確性確認
- アニメーション・トランジション確認

### 自動化制限
- 一部テストは手動確認必要
- 環境依存テストの扱い
- 視覚的品質の主観評価
- ユーザビリティテストとの連携

### モック戦略
- tkinter.Toplevel, tkinter.Frame のモック
- tkinter.filedialog のモック化
- イベント処理のシミュレーション
- 外部依存コンポーネントのスタブ化

## 合計テストケース数: 30個

### カテゴリ別内訳
- 基本機能: 3ケース
- 設定管理: 3ケース  
- ApplicationTab: 4ケース
- AppearanceTab: 5ケース
- GeneralTab: 3ケース
- UI/UX: 4ケース
- エラーハンドリング: 4ケース
- パフォーマンス: 3ケース
- 統合: 4ケース
- アクセシビリティ: 3ケース